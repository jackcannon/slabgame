<!doctype html>
<html>
  <head>
    <title>Slab Game!</title>
    <link rel="icon" type="image/png" href="./img/slab.png" />
    <style>
    html {
      text-align: center;
      background-image: url('./img/bg.png');
      background-size: cover;
      background-repeat: repeat-y;
      margin: 0;
      padding: 0;
      height: 100%;
    }
    body {
      background-color: rgba(0,0,0,0.75);
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    .option img { width: 150px; height: 150px; }
    #thoughtImage { width: 100px; height: 100px; }

    #choices {
      display: table;
      margin: auto;
    }

    .option {
      width: 200px;
      height: 200px;
      display: table-cell;
      vertical-align: middle;
      position: relative;
      overflow: hidden;
      background-repeat: no-repeat;
    }
      .option:hover {
        background-image: url('./img/shine-white.png');
      }

      .option img.pic {
        
      }
        .option:hover img.pic, .option.looking img.pic {
          transform: rotate(4deg) scale(1.05);
          -ms-transform: rotate(4deg) scale(1.05); /* IE 9 */
          -moz-transform: rotate(4deg) scale(1.05);
          -webkit-transform: rotate(4deg) scale(1.05); /* Safari and Chrome */
        }
        .option:nth-child(even):hover img.pic, .option:nth-child(even).looking img.pic {
          transform: rotate(-4deg) scale(1.05);
          -ms-transform: rotate(-4deg) scale(1.05); /* IE 9 */
          -moz-transform: rotate(-4deg) scale(1.05); 
          -webkit-transform: rotate(-4deg) scale(1.05); /* Safari and Chrome */
        }
        .option:active img.pic {
          transform: rotate(4deg) scale(1);
          -ms-transform: rotate(4deg) scale(1); /* IE 9 */
          -moz-transform: rotate(4deg) scale(1);
          -webkit-transform: rotate(4deg) scale(1); /* Safari and Chrome */
        }
        .option:nth-child(even):active img.pic {
          transform: rotate(-4deg) scale(1);
          -ms-transform: rotate(-4deg) scale(1); /* IE 9 */
          -moz-transform: rotate(-4deg) scale(1);
          -webkit-transform: rotate(-4deg) scale(1); /* Safari and Chrome */
        }

        .option.chosen.correct {
          background-image: url('./img/shine-green.png');
        }

        .option.chosen.wrong {
          background-image: url('./img/shine-red.png');
        }

        .option.looking {
          background-image: url('./img/shine-white.png');
        }

      #witt {
        position: absolute;
        bottom: 0px;
        right: 0px;
      }

      #speechBubble {
        background-image: url('./img/speech.png');
        width: 172px;
        height: 145px;
        position: absolute;
        bottom: 125px;
        right: 125px;
        display: none;
      }

        #speechText {
          font-size: 25px;
          font-family: Garamond;
        }

      #apprentice {
        position: absolute;
        bottom: 0px;
        left: 0px;
      }

      #thoughtBubble {
        background-image: url('./img/thought.png');
        width: 253px;
        height: 159px;
        position: absolute;
        bottom: 175px;
        left: 175px;
        display: none;
      }

        #thoughtImage {
          position: relative;
          top: 25px;
          right: -25px;
        }

    </style>
  </head>
  <body>
    <div id="choices">
      <div id="block" class="option"><img src="./img/block.png" class="pic" /></div>
      <div id="pillar" class="option"><img src="./img/pillar.png" class="pic" /></div>
      <div id="slab" class="option"><img src="./img/slab.png" class="pic" /></div>
      <div id="beam" class="option"><img src="./img/beam.png" class="pic" /></div>
    </div>

    <img id="witt" src="./img/witt.png" />
    <div id="speechBubble">
      <p id="speechText"></p>
    </div>

    <img id="apprentice" src="./img/apprentice.png" />
    <div id="thoughtBubble">
      <img id="thoughtImage" src="" />
    </div>

    <script src="./js/jquery-2.0.3.min.js"></script>
    <script>

    (function () {
      var options = ['block', 'pillar', 'slab', 'beam'];
      var correctAnswer = '';
      var canClick = true;
      var round = 0;

      $('.option').click(function (e) {
        if(canClick) {
          canClick = false;
          $(e.currentTarget).addClass('chosen');
          $('#speechBubble').hide();
          $('#thoughtBubble').hide();
          setTimeout(function () {
            setup();
          }, 3000);
        }
      });

      function setup() {
        canClick = true;
        correctAnswer = options[Math.floor(Math.random() * 4)];
        $('.option').removeClass('chosen');
        $('.option').removeClass('correct');
        $('.option').addClass('wrong');
        $('#' + correctAnswer).removeClass('wrong');
        $('#' + correctAnswer).addClass('correct');
        $('#speechBubble').show();
        $('#speechText').html(helper.capitalise(correctAnswer) + '!');
        setTimeout(function () {
          $('#thoughtBubble').show();
          if(round == 4) {
            $('#thoughtImage').attr('src', './img/football.png');
          } else {
            $('#thoughtImage').attr('src', './img/' + correctAnswer + '.png');
          }
          round++;
        }, 1000);
      }

      var helper = {
        capitalise: function (str) {
          if(typeof str !== 'string' || str.length == 0) return str;
          if(str.length == 1) return s.toUpperCase();
          return str.substr(0,1).toUpperCase() + str.substr(1).toLowerCase();
        }
      }

      setup();

      window.helper = helper;

    }());
    </script>
  </body>